# Картридж с решением
Адрес - `http://89.208.197.145:8081/index`
## Запуск
```bash
cartridge build
cartridge start
```

## Запросы
- POST /set - создать сокращённую ссылку на сайт    
    - параметр url - ссылка на сайт для сокращения
    - возвращает сокращённую ссылку
- GET /u/:id - переход по сокращённой ссылке (шлёт 301)
- GET /index - минималистичный веб-интерфейс + QR
- GET /stat/:id - статистика по укороченной ссылке (например, для `http://89.208.197.145:8081/u/4` id - `4` => путь `/stat/4`)
- GET /suggest/:id - рекомендации по укороченной ссылке (например, для `http://89.208.197.145:8081/u/4` id - `4` => путь `/suggest/4`)

## Файлы
- createredir-2_5min-analytics.csv - результаты теста создания и перехода по сокращённой ссылке за 2.5 мин.
- redir-5min-analytics.csv - результаты теста перехода по сокращённой ссылке за 5 мин.
- app/roles/url-db.lua - роль, рулящая базой
- app/roles/url-shorten-analytics.lua - роль для получения аналитики
- app/roles/url-shorten-front.lua - роль для основного фронта
- app/roles/url-shorten-suggest.lua - роль для подсказок

## Тест JMeter
Файл - `test.jmx`. Адрес сервера, порт прописывается в `HTTP Request Defaults`.
- группа `Test creation and redirection` рассчитана грузить 1000rps, создавая краткую ссылку и переходя по ней
- группа `Test only redirect` рассчитана грузить по максимуму только на переход по ссылке (ссылку вбить в путь `Test redirect`) 

## Статистика
Собирается общее кол-во переходов по ссылке и количество переходов на каждого `Referer'а`. 
Если `Referer` не указан - он `none`.

## Рекомендации
Сначала берутся первые 10 ссылок с похожим доменом. Если таких ссылок меньше 10, то список рекоммендаций
дополняется из списка всех ссылок.
